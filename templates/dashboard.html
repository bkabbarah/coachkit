{% extends "base.html" %}

{% block content %}
<div class="flex h-screen">
    
    <!-- Sidebar -->
    <div class="w-80 bg-white border-r flex flex-col">
        <div class="p-4 border-b">
            <div class="flex justify-between items-center mb-4">
                <h1 class="text-xl font-bold">CoachKit</h1>
                <a href="/logout" class="text-sm text-gray-500 hover:text-gray-700">Logout</a>
            </div>
            <input 
                type="text" 
                placeholder="Search clients..."
                class="w-full border rounded px-3 py-2"
                hx-get="/clients/search"
                hx-trigger="keyup changed delay:300ms"
                hx-target="#client-list"
                name="q"
            >
        </div>
        
        <div 
            id="client-list" 
            class="flex-1 overflow-y-auto"
            hx-get="/clients/search"
            hx-trigger="clientListChanged from:body, checkinAdded from:body"
            hx-vals='{"q": ""}'
        >
            {% for client in clients %}
            <div 
                class="p-4 border-b cursor-pointer hover:bg-gray-50 flex justify-between items-center"
                hx-get="/client/{{ client.id }}"
                hx-target="#client-detail"
                hx-swap="innerHTML"
            >
                <div>
                    <p class="font-medium">{{ client.name }}</p>
                    <p class="text-sm text-gray-500">{{ client.days_since_checkin() }} days ago</p>
                </div>
                {% if client.is_at_risk() %}
                    <span class="bg-red-100 text-red-700 px-2 py-1 rounded text-xs">At Risk</span>
                {% endif %}
            </div>
            {% endfor %}
        </div>
        
        <!-- Analytics Tray -->
        <div id="analytics-tray" class="border-t">
            <div 
                hx-get="/analytics/empty"
                hx-trigger="load"
                hx-swap="innerHTML"
                id="analytics-content"
            >
                <div class="p-3 text-center text-gray-400 text-sm">
                    Select a client to view analytics
                </div>
            </div>
        </div>
        
        <div class="p-4 border-t space-y-2">
            <button 
                class="w-full border border-gray-300 text-gray-700 px-4 py-2 rounded hover:bg-gray-50"
                hx-get="/import"
                hx-target="#modal-container"
                hx-swap="innerHTML"
            >
                üìÅ Import from Spreadsheet
            </button>
            <button 
                class="w-full bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"
                hx-get="/client/new"
                hx-target="#client-detail"
                hx-swap="innerHTML"
            >
                + Add Client
            </button>
        </div>
    </div>
    
    <!-- Main content area -->
    <div class="flex-1 bg-gray-50 overflow-y-auto">
        <div id="client-detail" class="p-8">
            <div class="text-center text-gray-500 mt-20">
                <p class="text-xl mb-2">Select a client</p>
                <p>Choose a client from the list to view their details</p>
            </div>
        </div>
    </div>
    
</div>
{% endblock %}